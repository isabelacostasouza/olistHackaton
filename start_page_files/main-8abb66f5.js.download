(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{338:function(e,t,n){"use strict";(function(e,t){t.ajaxSetup({beforeSend:function(t,n){var i;i=n.type,/^(GET|HEAD|OPTIONS|TRACE)$/.test(i)||this.crossDomain||t.setRequestHeader("X-CSRFToken",function(t){var n,i,o,r=null;if(document.cookie&&""!==document.cookie)for(i=document.cookie.split(";"),o=0;o<i.length;o+=1)if((n=e.trim(i[o])).substring(0,t.length+1)===t+"="){r=decodeURIComponent(n.substring(t.length+1));break}return r}("csrftoken"))}})}).call(this,n(39),n(39))},339:function(e,t,n){"use strict"},341:function(e,t,n){"use strict";(function(e){e((function(){document.addEventListener("copy",(function(t){var n,i,o=t.target;if(!o.dataset||!o.dataset.jsUnmasked)return!0;i=o.dataset.jsUnmasked,n=e(o).mask(i).cleanVal(),t.clipboardData.setData("text/plain",n),t.clipboardData.setData("text/html",n),t.preventDefault()}))}))}).call(this,n(39))},342:function(e,t,n){"use strict";(function(e){e((function(){var t=function(){var e=window.location.search.slice(1).split("&"),t={};return e.forEach((function(e){e=e.split("="),t[e[0]]=decodeURIComponent(e[1]||"")})),t},n={init:function(){n.boxCollapse(),n.btnActiveOnCheck(),n.btnCheckbox(),n.btnContactSupport(),n.btnLoading(),n.checkboxAll(),n.formSearchInput(),n.popoverBalloon()},boxCollapse:function(){var t=function(t){e('[data-widget~="box-collapse"]').each((function(n,i){var o=e(i),r=o.find(".united-box-body");o.addClass("collapsed"),t&&r.data("height",r.height()),r.css("height",r.data("height"))}))};e('[data-widget~="box-collapse"]').each((function(n,i){var o=e(i),r=o.find(".united-box-body"),a=r.height(),c=function(t,n){var i=e('<a class="trigger-open" />').prepend(t).append('<i class="mdi mdi-chevron-down"></i>'),o=e('<a class="trigger-close" />').prepend('<i class="mdi mdi-chevron-up"></i>').append(n);return e('<div class="united-box-trigger" />').append([i,o])}(i.dataset.openMessage,i.dataset.closeMessage);o.append(c),c.on("click",(function(){var e=o.hasClass("collapsed");t(),e&&(o.removeClass("collapsed"),r.css("height",a))}))})),t(!0)},btnActiveOnCheck:function(){e('[data-widget~="active-on-check"]').each((function(t,n){var i=n.dataset,o=i.activeClass,r=n.hasAttribute("disabled"),a=i.watchCheckbox,c=e(a),s=n.className;if(!c.length)return!1;c.on("change",(function(){if(e(a+":checked").length)return r&&n.removeAttribute("disabled"),o&&(n.className=o),!0;r&&n.setAttribute("disabled",!0),o&&(n.className=s)})).triggerHandler("change")}))},btnCheckbox:function(){e('[data-widget~="btn-checkbox"]').on("click",(function(t){var n=e(this),i=n.find("input:checkbox"),o="addClass",r=!0;if(t.target===i[0])return n.toggleClass("btn-checkbox-checked"),!0;i.is(":checked")&&(o="removeClass",r=!1),n[o]("btn-checkbox-checked"),i.prop("checked",r).triggerHandler("change")}))},btnContactSupport:function(){e('[data-widget~="btn-contact-support"]').each((function(t,n){e(n).on("click",(function(e){e.preventDefault(),Intercom("showNewMessage",n.dataset.message.replace(/_n/g,"\n"))}))}))},btnLoading:function(){e('[data-widget~="btn-loading"]').each((function(t,n){var i=e(n),o=function(){for(var t=0,n=e('<div class="spinner white" />');t<3;t+=1)n.append(e('<div class="bounce'+(t+1)+'" />'));return n};i.data("textCache",n.innerHTML),i.init.prototype.loading=function(t){var n=e(this),i=n.data("textCache");if(n.empty(),t)return n.addClass("loading").html(o);n.removeClass("loading").html(i)}}))},checkboxAll:function(){e('[data-widget~="checkbox-all"]').each((function(t,n){var i=e(n),o=i.data("target-selector"),r=e(o).not("[select-widget-disabled]");if(!r.length)return!1;i.on("change",(function(){r.prop("checked",this.checked).triggerHandler("change")})),r.on("change",(function(){var t=e(o+":checked").length===r.length;i.prop("checked",t)}))}))},formSearchInput:function(){e('[data-widget~="form-search"]').each((function(n,i){var o=e(i),r=o.find(".button"),a=r.find(".icon");o.on("submit",(function(){a.removeClass("mdi-magnify").addClass("loading")})),t().search&&(a.removeClass("mdi-magnify").addClass("mdi-close"),r.attr("type","button").on("click",(function(){window.location=t().refer})))}))},popoverBalloon:function(){e('[data-widget~="popover-balloon"]').each((function(t,n){var i=e(n),o=e(i.data("target")),r=!1;if(!o.length)return!1;i.hover((function(){o.addClass("active")}),function(e,t){var n;return function(){var i=this;clearTimeout(n),n=setTimeout((function(){e.apply(i,arguments)}),t)}}((function(){if(r)return!1;o.removeClass("active")}),500)),o.hover((function(){r=!0}),(function(){r=!1,o.removeClass("active")}))}))}};n.init(),window.united={widgets:n}}))}).call(this,n(39))},343:function(e,t,n){"use strict";(function(e,t){e((function(){var n={$loading:e('[united-component="order-loading"]'),$modalPlace:null,id:null,lastURI:null,messages:{fail:{message:gettext("Verify the format of the file is a valid .XML."),title:gettext("Error on send .xml file")},invalid:{title:gettext("The invoice .xml file was not appended because it contains the following errors:")},status:{partial:gettext("partially invoiced"),total:gettext("invoiced")}},orderModalSelector:'[united-component~="order-modal"]',orderVolumeSelector:'[united-component~="order-volume"]',ordersCheckboxSelector:'[data-js="orders-checkboxes"]',toasterItem:null,rowLink:"tr[data-href]",unclickableAttr:"tr-click-disabled",notification:'[data-js="alert-notification"]',alertComponent:"alert-notification",alertTitle:'[data-ref="alert-title"]',alertItem:'[data-ref="alert-item"]',orderVolumeStatus:'[data-js="order-volume-status"]',orderVolumeError:'[united-component="order-volume-error"]',init:function(){n.uploadEvents(),n.modalEvents(),n.navigation(),n.navigationEvents()},$orderModal:function(){return e(n.orderModalSelector)},uploadEvents:function(){e(n.orderVolumeSelector).on("volume:upload-change",(function(t){var i=t.originalEvent.detail,o=n.messages.fail,r=o.message,a=e(this),c=a.find(n.orderVolumeError),s=a.find(n.notification),d=a.find(n.alertComponent),l=a.find(n.orderVolumeStatus);return"success"===i?(a.removeClass("order-volume-warning"),s.hide(),l.hide(),c.css("visibility","hidden")):"error"===i?s.fadeOut(150,(function(){d.removeAttr("messages"),d.attr("title",o.title),d.attr("description",r)})).fadeIn(250):void 0})),e(n.orderVolumeSelector).on("invoice:validation:invalid",(function(){var t=e(this),n=t.next('[data-js="invoice-alert"]'),i=n.find("invoice-alert");!!i.attr("invoice-errors")&&(i.attr("invoice-errors",null),t.find(".order-volume-invoice-error").css("visibility","hidden")),n.removeClass("hidden")})),e(n.orderVolumeSelector).on("invoice:validation:valid",(function(){var t=e(this),n=t.next('[data-js="invoice-alert"]'),i=n.hasClass("hidden");t.hasClass("order-volume-warning")&&(t.removeClass("order-volume-warning"),t.find(".order-volume-invoice-error").css("visibility","hidden")),i||n.addClass("hidden")}))},createModalPlace:function(t){return e('<div id="'+t+'" />').appendTo("body")},modalStart:function(){n.orderId=n.$orderModal().get(0).id,window.united.widgets.btnContactSupport(),window.united.widgets.btnLoading(),window.united.widgets.popoverBalloon(),window.newPopover(),n.uploadEvents(),n.modalEvents(),n.ship.modalOrderSubmit(),n.merge()},modalEvents:function(){var t=function(){return e('[data-invoice-attached="true"]')};e(n.orderVolumeSelector).on("volume:upload-change",(function(){var i=n.messages.status,o=e('[united-component="order-status"]'),r=o.find("span.badge"),a=o.find("span:last-child");return 0!==t().length&&(t().length===e(n.orderVolumeSelector).length?(r.removeClass("badge-alternate").addClass("badge-success"),function(){var t=e('[united-component="'+n.orderId+'"]');n.toasterItem={message:gettext("order invoiced with success!"),type:"success"},!!t.length&&("/volumes/invoices/"===n.lastLocation?t.remove():t.find(".status-text").text(gettext("Waiting invoice")))}(),a.text(i.total)):(r.removeClass("badge-success").addClass("badge-alternate"),void a.text(i.partial)))}))},navigation:function(){e(n.rowLink).on("click",(function(i){var o=this.dataset.href,r=i.target,a=e(r).closest("["+n.unclickableAttr+"]");if(r.hasAttribute(n.unclickableAttr)||a.length)return!0;n.lastLocation=window.location.pathname,t.clear(),window.history.pushState(o,null,o),n.requestContent(o)}))},navigationEvents:function(){window.addEventListener("popstate",(function(e){return e.state?n.requestContent(e.state):(n.$loading.modal("hide"),n.$orderModal().length?void n.$orderModal().off().on("hidden.bs.modal",(function(){n.$modalPlace.remove()})).modal("hide"):n.$modalPlace.remove())})),n.$orderModal().on("hidden.bs.modal",(function(){var t=window.location.pathname.split("/").slice(0,-2).join("/")+"/";window.history.pushState(null,null,t),e(this).remove()}))},requestContent:function(t){var i=Date.now();n.$modalPlace=n.createModalPlace(i),n.$loading.modal("show"),n.$modalPlace.load(t+"modal/ "+n.orderModalSelector,(function(){e("#"+i).length&&n.$loading.modal("hide"),n.refreshSVGIcons(),n.$orderModal().modal("show").on("shown.bs.modal",(function(){e("body").addClass("modal-open"),n.modalStart()})).on("hidden.bs.modal",(function(){n.toasterFire(),n.$modalPlace.remove(),window.history.back()}))}))},toasterFire:function(){var e=n.toasterItem;if(!e)return!1;e.className&&(t.options.iconClasses={},t.options.iconClasses[e.type]=e.className),t.options.positionClass="toast-bottom-center",t[e.type](e.message),n.toasterItem=null},refreshSVGIcons:function(){e(".svg").each((function(t,n){var i=e(n),o=i.clone(),r=i.parent();i.remove(),r.append(o)}))}},i=e(".modal.order");window.united.volume=n,n.init(),i.length&&i.modal("show")}))}).call(this,n(39),n(185))},345:function(e,t,n){"use strict";(function(e,t){e((function(){var n={formSelector:'[data-js="orders-invoice"]',ordersCheckboxSelector:'[data-js="orders-checkboxes"]',messages:{exportError:gettext("Could not export orders. Try again.")},init:function(){n.attachEvents()},attachEvents:function(){e(n.formSelector).on("submit",(function(i){var o=e(n.ordersCheckboxSelector).filter(":checked").map((function(){return this.value})).get();i.preventDefault(),window.united.volume.$loading.modal("show"),t.clear(),e.post(this.action,{codes:o}).then((function(e){n.downloadCSV(e)})).catch((function(){window.united.volume.toasterItem={message:n.messages.exportError,type:"error"},window.united.volume.toasterFire()})).always((function(){window.united.volume.$loading.modal("hide")}))}))},downloadCSV:function(t){var n=encodeURIComponent(t),i=e("<a />",{href:"data:application/csv;charset=utf-8,"+n,download:"list.csv"}).appendTo(document.body);i[0].click(),i.remove()}};n.init()}))}).call(this,n(39),n(185))},346:function(e,t,n){"use strict";(function(e){e((function(){var t=function(){var t='[united-component~="order-modal"]',n=function(){return e(".alert.alert-danger")},i=function(t){e.get(window.location.href,(function(n){var i=e(n).find('[united-component~="order-modal"]').html();e('[united-component~="order-modal"]').html(i),setTimeout((function(){window.united.volume.modalStart()}),500),t()}))};e('[data-js="button-merge"]').on("click",(function(){e(t).addClass("merge-mode")})),e('[data-js="button-merge-cancel"]').on("click",(function(){e(t).removeClass("merge-mode")})),e('[data-js="button-merge-undo"]').on("click",(function(){var o=e("[data-volume-merged]").data("volume-id"),r=this.dataset.undoMergeUrl,a=e(this);a.loading(!0),n().hide(),e.post(r,JSON.stringify({volume_id:o})).then((function(){i((function(){a.loading(!1),e(t).removeClass("merge-done")}))})).catch((function(){n().html(gettext("Could not undo volume merge. Try again.")).show(),a.loading(!1)}))})),e("volumes-merge form").on("volume-merge:done",(function(){i((function(){e(t).removeClass("merge-mode").addClass("merge-done")}))})).on("volume-merge:start",(function(){e('[data-js="button-merge-cancel"]').attr("disabled",!0),n().empty().hide()})).on("volume-merge:error",(function(){e('[data-js="button-merge-cancel"]').attr("disabled",!1)})),e("[data-volume-merged]").length&&e(t).addClass("merge-done")};e.extend(window.united.volume,{merge:t}),t()}))}).call(this,n(39))},347:function(e,t,n){"use strict";(function(e,t){e((function(){var n={carrierBlockSelector:'[data-js="carrier-block"]',ordersCheckboxSelector:'[data-js="orders-checkboxes"]',mainURL:"/volumes/shipment/",messages:{counter:function(e,t){return interpolate(ngettext("%s order selected for %s","%s orders selected for %s",e),[e,t])},error:gettext("Unable to generate shipment labels. Try again!"),partial:gettext("generate shipping labels for selected orders"),total:gettext("generate shipping labels for all orders"),success:function(e){return[gettext("processing labels."),' <a href="'+e+'">',gettext("post orders"),"</a>"].join("")}},modalSelector:'[data-js="shipment-confirmation"]',refreshAreaSelector:".volume-refresh-area",generatePlpListBtn:'[data-js="generate-plp-list-btn"]',generatePlpListWrapper:'[data-js^="modal-plp-list-"]',selectableRows:"tr[select-on-click]",plpErrorAlert:'[data-js="plp-error-alert"]',init:function(){n.btnGenerateLabels(),n.formEvents(),n.modalSubmit(),n.modalOrderSubmit(),n.createTemplateList(),n.setupPlpListEvents()},createTemplateList:function(){var t=e(n.carrierBlockSelector),i=t.clone().get(0);i&&(n.blockCloned=i.outerHTML),t.remove(),n.$blockPlace=function(){return e(n.modalSelector).find('[data-js="confirmation-body"]')}},btnGenerateLabels:function(){e('[data-widget~="btn-generate-labels"]').each((function(t,i){var o=e(n.ordersCheckboxSelector),r=n.messages;o.on("change",(function(){var e=o.length,t=o.filter(":checked").length;if(t>0&&t<e)return i.innerText=r.partial,!0;i.innerText=r.total}))}))},requestRefreshedPage:function(t,i){var o=e(n.refreshAreaSelector);e.ajax({url:t,dataType:"html",success:function(t){var r=e(t).find(n.refreshAreaSelector);o.replaceWith(r),i&&i(),window.united.widgets.init(),window.united.volume.init(),n.init()}})},formEvents:function(){var i=e("#order_shipment"),o=e(n.modalSelector),r=function(){var t={};return function(){var t=e(n.ordersCheckboxSelector).filter(":checked").map((function(e,t){return'[united-component="order-'+t.value+'"]'})).toArray();return e(t.join(","))}().each((function(n,i){var o=i.dataset.carrier,r=e(i).clone().removeAttr("united-component data-href")[0];t[o]||(t[o]=[]),t[o].push(r)})),t};o.on("hide.bs.modal",(function(){n.$blockPlace().empty()})),i.on("submit",(function(i){var a=r();i.preventDefault(),t.clear(),e(n.modalSelector).find(".alert-danger").hide(),Object.keys(a).forEach((function(t){var i=n.messages,o=a[t],r=e(o[0]).find('[data-js="carrier-name"]').text(),c=e(n.blockCloned),s=c.find('[united-component="shipment-table"] tbody'),d=c.find('[united-component="shipment-counter"]');s.html(o),d.html(i.counter(o.length,r)),n.$blockPlace().append(c)})),o.modal("show")}))},modalSubmit:function(){e('[united-component="shipment-submit"]').off().on("click",(function(){var t=e(n.modalSelector).find(".alert-danger");n.submitOrders(this,t,e(n.modalSelector).find(n.ordersCheckboxSelector+":checked").toArray().map((function(e){return{code:e.value,status:e.dataset.status}})))}))},modalOrderSubmit:function(){var t=e(window.united.volume.orderModalSelector).find(".alert-danger");e('[data-widget~="order-submit"]').on("click",(function(){var e={code:this.dataset.orderId,status:this.dataset.orderStatus};n.submitOrders(this,t,[e])}))},submitOrders:function(t,i,o){var r=e(t),a=n.messages,c=t.dataset.endpointUrl,s=t.dataset.urlGoto,d=function(){r.loading(!1),window.united.volume.toasterFire()},l=e.ajax({url:c,type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify(o)});i.hide(),r.loading(!0),l.then((function(){n.requestRefreshedPage(c,(function(){window.united.volume.toasterItem={message:a.success(s),type:"success",className:"toast-success-waiting"},e('[united-component~="modal"]').modal("hide"),d()}))})).catch((function(e){var t=e.message||a.error;i.html(t).show(),d()}))},setupPlpListEvents:function(){e(n.generatePlpListBtn).on("click",(function(){var t=e(this),i=e(this).closest(n.generatePlpListWrapper),o=i.find(n.plpErrorAlert),r=i.find(n.ordersCheckboxSelector).filter(":checked"),a=i.attr("data-submit-url"),c=r.map((function(){return{order_code:e(this).attr("value"),expiration_date:e(this).attr("data-shipping-limit-date")}})).get(),s=c.map((function(e){return e.order_code})),d=function(){e.post(a,{orders:s}).done((function(){window.location.reload()})).fail((function(){o.show(),t.loading(!1),t.attr("disabled",!1)}))};t.loading(!0),t.attr("disabled",!0);try{mixpanel.track("Clicked on Regenerate PLP",{seller_email:window.user.email,seller_id:window.user.userId,orders:c},d)}catch(l){d()}})),e(n.selectableRows).on("click",(function(){var t=e(this).find(n.ordersCheckboxSelector).not("[select-widget-disabled]");t&&t.prop("checked",!t.prop("checked")).change()}))}};e.extend(window.united.volume,{ship:n}),n.init()}))}).call(this,n(39),n(185))},348:function(e,t,n){"use strict";(function(e){e((function(){var t,n={minValue:{title:gettext("Minimum value not permitted"),description:gettext("You can only publish products with prices above R$ 6.00.")},priceUpLocked:{title:gettext("Change not allowed"),description:gettext("During <strong>Black Friday</strong>, prices can not be increased.")}},i={price:{minValue:n.minValue,priceUpLocked:n.priceUpLocked},offer:{greaterThanPrice:{title:gettext("Value not permitted"),description:gettext("The promotional price can't be greater than the normal price.")},greaterThan50percent:{title:gettext("Discount not permitted"),description:gettext("The discount can't be greater than 50%.")},minValue:n.minValue,priceUpLocked:n.priceUpLocked},update:gettext("could not update")},o={init:function(){o.config={productItem:'[data-js="product-item"]',input:'[data-js="product-item"] input',inputCurrency:'[data-js|="currency"]',inputValuesCurrency:'[data-js="values_currency"]',inputInCampaign:'[data-js="in_campaign"]',inputFullyRestrictedPrice:'[data-js="fully_restricted_price"]',inputMinimumQuantity:'[data-js="minimum_quantity"]',inputHandlingTime:'[data-js="handling-time"]',inputStock:'[data-js="stock"]',inputPrice:'[data-js="currency-price"]',inputOffer:'[data-js="currency-offer"]',competitivity:'[data-competitivity]:not(".hidden")',competitivityHigh:'[data-competitivity="high"]',competitivityLow:'[data-competitivity="low"]',competitivityLowestPrice:'[data-js="competitivity-lowest-price"]',stockAndPriceCalculator:'[data-js="stock-and-price-calculator"]',suggestedPrice:"[data-suggested-price]",formHint:'[data-js="form-hint"]',formSuccess:'[data-js="form-success"]',formLoading:'[data-js="form-loading"]',smartPriceBtn:'[data-js="smart-price-button"]',singlePricing:"data-single-pricing",isEnablePriceVariation:"data-is-enable-price-variation",modal:'[united-component="modal"]',modalFromPrice:"[data-from-price]",modalToPrice:"[data-to-price]",modalDiscount:"[data-discount]",modalSubmitButton:"[data-modal-button]",modalCloseButton:'[data-widget="modal-close"]'},o.setupInputMasks(),o.setupEvents()},setupInputMasks:function(){e(o.config.inputCurrency).maskMoney({thousands:".",decimal:","}).maskMoney("mask"),e(o.config.inputStock).mask("#"),e(o.config.inputHandlingTime).mask("#"),e(o.config.inputCurrency).off("click.maskMoney")},openModal:function(){var t=e("body"),n=e(o.config.modal);t.addClass("modal-open"),n.show()},closeModal:function(){var t=e("body"),n=e(o.config.modal);t.removeClass("modal-open"),n.hide()},updateModalData:function(t,n,i){var r={minimumFractionDigits:2,style:"currency",currency:"BRL"};e(o.config.modalFromPrice).html(n.toLocaleString("pt-BR",r)),e(o.config.modalToPrice).html(i.toLocaleString("pt-BR",r)),e(o.config.modalDiscount).html(o.calculatePercentage(i,n)),e(o.config.modalSubmitButton).attr("data-product-id",t)},setupEvents:function(){e(o.config.productItem).on({focus:function(){e(this).parents(o.config.productItem).find(o.config.formSuccess).hide(),o.toggleFormHint({productId:e(this).parents(o.config.productItem).attr("data-sku"),isHidden:!1})},blur:function(){var t=e(this).parents(o.config.productItem).attr("data-sku");o.toggleFormHint({productId:t,isHidden:!o.isFormChanged(t)})},keyup:function(t){var n=t.keyCode?t.keyCode:t.which,i=e(this).parents(o.config.productItem),r=i.attr("data-sku"),a=i.find(o.config.inputPrice),c=i.find(o.config.inputOffer),s=Number(a.maskMoney("unmasked")[0]),d=Number(c.maskMoney("unmasked")[0]),l=Number(e(c).attr("data-origin-value")),u=Number(i.find(o.config.inputStock).val()),f=Number(i.find(o.config.inputHandlingTime).val()),m=e(this).parents("tbody").attr(o.config.singlePricing),p=e(this).parents("tbody").attr(o.config.isEnablePriceVariation),g=o.validatePriceDecrease(l,d,50);if("true"===m&&a.val(c.val()),27===n&&o.isFormChanged(r))return o.resetForm(r);if(o.isFormChanged(r)?e(this).parents(o.config.productItem).find(o.config.formHint).addClass("-color-yellow"):e(this).parents(o.config.productItem).find(o.config.formHint).removeClass("-color-yellow"),o.validateForm(r).isValid()&&(o.renderHintErrors({productId:r,hasError:!1}),o.renderInputErrors({productId:r,priceErrors:o.validateForm(r).errors().price,offerErrors:o.validateForm(r).errors().offer})),13===n&&o.isFormChanged(r)){if(!o.validateForm(r).isValid())return o.renderHintErrors({productId:r,hasError:!0}),o.renderInputErrors({productId:r,priceErrors:o.validateForm(r).errors().price,offerErrors:o.validateForm(r).errors().offer}),!1;if(e(this).blur(),p&&g)return o.updateModalData(r,l,d),o.openModal();o.submit(r,f,u,s,d)}}},"input"),e(o.config.modalCloseButton).on({click:function(){o.closeModal()}}),e(o.config.modalSubmitButton).on({click:function(t){var n=e(this).attr("data-product-id"),i=o.getFormById(n),r=i.find(o.config.inputPrice),a=i.find(o.config.inputOffer),c=Number(r.maskMoney("unmasked")[0]),s=Number(a.maskMoney("unmasked")[0]),d=Number(i.find(o.config.inputHandlingTime).val()),l=Number(i.find(o.config.inputStock).val());if(t.preventDefault(),o.closeModal(),!o.validateForm(n).isValid())return o.renderHintErrors({productId:n,hasError:!0}),o.renderInputErrors({productId:n,priceErrors:o.validateForm(n).errors().price,offerErrors:o.validateForm(n).errors().offer}),!1;o.submit(n,d,l,c,s)}}),e(o.config.inputCurrency).on({keyup:function(){if(Number(e(this).attr("data-origin-value"))!==e(this).maskMoney("unmasked")[0])return e(this).addClass("-bg-color-yellow"),e(this).parents(o.config.productItem).find(o.config.formHint).addClass("-color-yellow");e(this).removeClass("-bg-color-yellow"),e(this).parents(o.config.productItem).find(o.config.formHint).removeClass("-color-yellow")}}),e(o.config.inputStock).on({blur:function(){e(this).val()||(e(this).val("0"),e(this).trigger("keyup"))},keyup:function(){if(Number(e(this).attr("data-origin-value"))!==Number(e(this).val()))return e(this).addClass("-bg-color-yellow"),e(this).parents(o.config.productItem).find(o.config.formHint).addClass("-color-yellow");e(this).removeClass("-bg-color-yellow"),e(this).parents(o.config.productItem).find(o.config.formHint).removeClass("-color-yellow")}}),e(o.config.inputHandlingTime).on({blur:function(){e(this).val()||(e(this).val("0"),e(this).trigger("keyup"))},keyup:function(){if(Number(e(this).attr("data-origin-value"))!==Number(e(this).val()))return e(this).addClass("-bg-color-yellow"),e(this).parents(o.config.productItem).find(o.config.formHint).addClass("-color-yellow");e(this).removeClass("-bg-color-yellow"),e(this).parents(o.config.productItem).find(o.config.formHint).removeClass("-color-yellow")}}),e(o.config.competitivityLow).on({mouseenter:function(){o.hasCalculator(this)&&(t=new Date)},mouseleave:function(){var n=e(this).parents(o.config.productItem).attr("data-sku"),i=o.getFormById(n),r=i.find(o.config.inputPrice).attr("data-origin-value"),a=i.find(o.config.inputOffer).attr("data-origin-value"),c=i.find(o.config.inputHandlingTime).attr("data-origin-value"),s=i.find(o.config.inputStock).attr("data-origin-value"),d=i.attr("data-gtin"),l=function(){if(t)return new Date-t}(),u={};o.hasCalculator(this)&&l&&(u=o.trackingPopover(l,c,r,a,s,d,n),mixpanel.track(u.mouseleave.action,u.mouseleave.info))}}),e(o.config.smartPriceBtn).on({"smart-price:update":function(t){var n=e(this).parents(o.config.productItem),i=n.attr("data-sku"),r=t.detail.price,a=Number(n.find(o.config.inputStock).val()),c=Number(n.find(o.config.inputHandlingTime).val());if(n.find(o.config.inputOffer).maskMoney("mask",r),n.find(o.config.inputPrice).maskMoney("mask",r),!o.validateForm(i).isValid())return o.renderHintErrors({productId:i,hasError:!0}),o.renderInputErrors({productId:i,priceErrors:o.validateForm(i).errors().price,offerErrors:o.validateForm(i).errors().offer}),!1;o.submit(i,c,a,r,r)}})},calculatePercentage:function(e,t){return parseFloat(((t-e)/t*100).toFixed(2))},validatePriceDecrease:function(e,t,n){var i=function(e){return e<0},r=!e||!t||!n,a=i(e)||i(t)||i(n),c=o.calculatePercentage(t,e);return!r&&!a&&c>=n},submit:function(t,n,i,r,a){var c,s=o.getFormById(t),d=s.find(o.config.formLoading),l=s.find(o.config.formHint),u=s.find("input:enabled"),f=s.find(o.config.inputInCampaign),m=s.find(o.config.inputFullyRestrictedPrice),p=s.find(o.config.inputMinimumQuantity),g=s.find(o.config.inputHandlingTime),h=s.find(o.config.inputStock),v=s.find(o.config.inputValuesCurrency),b=s.find(o.config.inputPrice),k=s.find(o.config.inputOffer),w=s.find(o.config.formSuccess),y=s.find(o.config.competitivityHigh),C=s.find(o.config.competitivityLow),S=s.find(o.config.competitivityLowestPrice),x=s.attr("data-gtin"),I=s.find(o.config.competitivity).attr("data-competitivity"),E=Number(s.find(o.config.inputPrice).attr("data-origin-value")),P=Number(s.find(o.config.inputOffer).attr("data-origin-value")),j=Number(s.find(o.config.inputHandlingTime).attr("data-origin-value").replace(".","")),L=Number(s.find(o.config.inputStock).attr("data-origin-value").replace(".","")),V=Number(s.find(o.config.suggestedPrice).attr("data-suggested-price")),T=Number(S.attr("data-lowest-price")),H=r!==E,M=a!==P,N=n!==j,F=i!==L,$=s.parents("tbody").attr("data-href-update"),B={csrfmiddlewaretoken:e('[name="csrfmiddlewaretoken"]').val(),sku:t,availability_days:g.val(),quantity:h.val(),minimum_quantity:p.val(),value:b.val(),offer:k.val(),currency:v.val(),in_campaign:f.val(),fully_restricted_price:m.val(),has_price_changed:H||M,has_stock_changed:F,has_handling_time_changed:N},O=function(){u.attr("disabled",!1)};c=o.trackingForm(n,i,r,a,j,L,E,P,I,V,x),d.show(),l.hide().removeClass("-color-yellow"),u.removeClass("-bg-color-yellow").attr("disabled",!0),e.post($,B).done((function(){var t,l,f,m;O(),t=n,l=i,f=r,m=a,g.attr("data-origin-value",t),h.attr("data-origin-value",l),b.attr("data-origin-value",f),k.attr("data-origin-value",m),T&&function(){if(a<=T)return C.addClass("hidden"),y.removeClass("hidden").addClass("animate"),!1;y.addClass("hidden"),C.removeClass("hidden").addClass("animate")}(),d.hide(),c&&c.success&&mixpanel.track(c.success.action,c.success.info),function(){var t=e(s.find(o.config.smartPriceBtn))[0],n=Number(s.find(o.config.inputOffer).maskMoney("unmasked")[0]),i=new CustomEvent("update-success",{detail:{newPrice:n}});w.show(),u.addClass("-success"),setTimeout((function(){w.hide(),u.removeClass("-success")}),3e3),t&&t.dispatchEvent(i)}()})).fail((function(e){O(),d.hide(),c&&c.error&&mixpanel.track("Validation error",{type:c.error,message:e.statusText}),o.renderHintErrors({productId:t,hasError:!0}),u.addClass("-error"),setTimeout((function(){u.removeClass("-error")}),3e3)}))},toggleFormHint:function(t){var n=t.productId;if(t.isHidden)return e("tr[data-sku="+n+"]").find(o.config.formHint).hide();e("tr[data-sku="+n+"]").find(o.config.formHint).show()},isFormChanged:function(t){var n=[o.config.inputPrice,o.config.inputOffer,o.config.inputHandlingTime,o.config.inputStock].join(",");return e("tr[data-sku="+t+"]").find(n).filter((function(t,n){return 0===t||1===t?Number(e(n).attr("data-origin-value"))!==Number(e(n).val()):Number(e(n).attr("data-origin-value"))!==e(n).maskMoney("unmasked")[0]})).length>0},resetForm:function(t){var n=[o.config.inputPrice,o.config.inputOffer,o.config.inputHandlingTime,o.config.inputStock].join(",");return e("tr[data-sku="+t+"]").find(n).filter((function(t,n){var i=0===t,o=1===t,r=Number(e(n).attr("data-origin-value"));return i||o?e(n).val(r).trigger("keyup").blur():e(n).maskMoney("mask",r).trigger("keyup").blur()})).length>0},validateForm:function(t){var n=e("tr[data-sku="+t+"]"),i=n.attr("data-price-up"),r=n.find(o.config.inputPrice).maskMoney("unmasked")[0],a=Number(n.find(o.config.inputPrice).attr("data-origin-value")),c=n.find(o.config.inputOffer).maskMoney("unmasked")[0],s=Number(n.find(o.config.inputOffer).attr("data-origin-value")),d=n.parents("tbody").attr(o.config.isEnablePriceVariation),l={price:[],offer:[]},u=c<.5*r,f=function(){return l.price.indexOf("minValue")},m=function(){return l.offer.indexOf("minValue")};return"locked"===i&&(r>a&&l.price.push("priceUpLocked"),c>s&&l.offer.push("priceUpLocked")),c>r&&l.offer.push("greaterThanPrice"),u&&!d&&l.offer.push("greaterThan50percent"),r<6&&l.price.push("minValue"),c<6&&l.offer.push("minValue"),a<6&&-1!==f()&&l.price.splice(f,1),s<6&&-1!==m()&&l.offer.splice(m,1),{isValid:function(){return 0===l.price.length&&0===l.offer.length},errors:function(){return l}}},renderHintErrors:function(t){var n=t.productId,r=t.hasError,a=e("tr[data-sku="+n+"]");if(r)return a.attr("data-has-error",r).find(o.config.formHint).text(i.update).addClass("-color-red").show();a.attr("data-has-error",!1).find(o.config.formHint).text(gettext("press enter to save")).removeClass("-color-red")},renderInputErrors:function(t){var n=t.productId,r=t.priceErrors,a=t.offerErrors,c=e("tr[data-sku="+n+"]"),s=c.find(o.config.inputPrice),d=c.find(o.config.inputOffer),l=function(e){var t=e.$input;if(e.isVisible)return t.addClass("-error").parent().addClass("-error");t.removeClass("-error").parent().removeClass("-error")},u=function(e){var t=e.$input.parent(),n=e.errors,o=e.fieldName,r=t.find(".united-popover__title"),a=t.find(".united-popover__body");if(1===n.length)return r.text(i[o][n[0]].title),a.html(""),a.append('<p class="text-muted">'+i[o][n[0]].description+"</p>");r.text(gettext("Price not permitted")),a.html(""),n.forEach((function(e){a.append('<p class="text-muted">'+i[o][e].description+"</p>")}))};r.length>0?(l({$input:s,isVisible:!0}),u({$input:s,errors:r,fieldName:"price"})):l({$input:s,isVisible:!1}),a.length>0?(l({$input:d,isVisible:!0}),u({$input:d,errors:a,fieldName:"offer"})):l({$input:d,isVisible:!1})},hasCalculator:function(t){return e(t).has(o.config.stockAndPriceCalculator).length>0},trackingPopover:function(e,t,n,i,o,r,a){return{mouseleave:{action:"Stock & Price - Viewed Calculator",info:{GTIN:r,SKU:a,stock:o,handlingTime:t,"from price":n,"to price":i,"time open ms":e}}}},trackingForm:function(e,t,n,i,o,r,a,c,s,d,l){return{success:{action:"Stock & Price - Updated Item",info:{GTIN:l,competitiveness:s,"suggested price":d,"old from price":a,"new from price":n,"old to price":c,"new to price":i,"new handling time":e,"old handling time":o,"new stock":t,"old stock":r}},error:"product-update"}},getFormById:function(t){return e("tr[data-sku="+t+"]")}};o.init()}))}).call(this,n(39))},349:function(e,t,n){"use strict";(function(e){!function(){var t=function(){var e=window.location.search.slice(1).split("&"),t={};return e.forEach((function(e){e=e.split("="),t[e[0]]=decodeURIComponent(e[1]||"")})),t},n={init:function(){n.config={form:'[data-js="search"]',input:'[data-js="search-input"]',reset:'[data-js="search-reset-button"]',search:'[data-js="search-action-button"]',select:'[data-js="united-select-readonly"]'},n.handleInputBorder(),n.handleButtonIcon(),n.handleInputWidth(),n.setupEvents(),e(n.config.select).length&&n.setupSelect()},isLoading:!1,isReset:!1,isSelectChanged:!1,handleInputBorder:function(){if(e(n.config.input).val())return e(n.config.input).addClass("is-active");e(n.config.input).removeClass("is-active")},handleButtonIcon:function(){var i=e(n.config.input).val(),o=t().search;if(i===(o&&o.replace(/\+/g," "))&&i)return n.isReset=!0,e(n.config.form).find("i").removeClass("mdi-magnify").addClass("mdi-close"),e(n.config.form).find("button").attr("data-href",e(n.config.form).attr("data-href-endpoint"));n.isReset=!1,e(n.config.form).find("i").removeClass("mdi-close").addClass("mdi-magnify")},handleInputWidth:function(){var t=e(n.config.input),i=t.textWidth()+60;t.css({width:i,"min-width":i})},showLoadingIcon:function(){n.isSelectChanged||e(n.config.form).find("i").removeClass("mdi-close mdi-magnify").addClass("loading")},setupEvents:function(){e(n.config.form).on("keyup","input",(function(e){if(13===e.keyCode)return!1;n.handleInputBorder(),n.handleButtonIcon()})),e(n.config.form).on("submit",(function(i){var o=e(this).find("button").attr("data-href"),r=t().ordering;if(i.preventDefault(),n.showLoadingIcon(),n.isReset)return r?(window.location=o+"?ordering="+r,null):(window.location=o,null);e(this).off("submit").submit()})),e(n.config.input).on("input",(function(){n.handleInputWidth()}))},setupSelect:function(){e(n.config.select).selectize({onInitialize:function(){this.$control_input.attr("readonly",!0)},onChange:function(){n.isReset=!1,n.isSelectChanged=!0,e(n.config.form).submit()}})}};e.fn.textWidth=function(t,n){var i=t||this.val()||this.text()||this.attr("placeholder"),o=n||this.css("font");return e.fn.textWidth.fakeEl||(e.fn.textWidth.fakeEl=e("<span>").hide().appendTo(document.body)),e.fn.textWidth.fakeEl.text(i).css("font",o),e.fn.textWidth.fakeEl.width()},n.init()}()}).call(this,n(39))},350:function(e,t,n){"use strict";(function(e){!function(){var t={init:function(){t.config={container:'[data-js="news-popover"]',closeButton:'[data-js="close"]',popoverVisibilityClass:"[data-js-popover-visibility-class]",localStorageKey:"[data-js-local-storage-key]"},e(t.config.container).length&&(t.setPageLocalStorage(),t.handlePopoverVisibility(),t.setupEvents())},pageLocalStorage:{},numbersVisited:0,setPageLocalStorage:function(){var n=e(t.config.localStorageKey).attr("data-js-local-storage-key");if(void 0===n)throw new Error("Key is not defined for news popover.");t.pageLocalStorage={key:n,closed:n+"-closed",visited:n+"-visited"}},close:function(){e(t.config.popoverVisibilityClass).removeClass(e(t.config.popoverVisibilityClass).attr("data-js-popover-visibility-class")),e(t.config.container).removeClass("active"),localStorage.setItem(t.pageLocalStorage.closed,!0)},show:function(){e(t.config.popoverVisibilityClass).addClass(e(t.config.popoverVisibilityClass).attr("data-js-popover-visibility-class")),e(t.config.container).addClass("active")},visited:function(){var e=localStorage.getItem(t.pageLocalStorage.visited),n=parseInt(e,10);if(!n)return localStorage.setItem(t.pageLocalStorage.visited,1);n<3&&localStorage.setItem(t.pageLocalStorage.visited,n+1)},handlePopoverVisibility:function(){var e=localStorage.getItem(t.pageLocalStorage.visited);!localStorage.getItem(t.pageLocalStorage.closed)&&e<3&&t.show(),t.visited()},setupEvents:function(){e(t.config.closeButton).on("click",(function(){t.close()})),e(document).on("keyup",(function(e){27===e.keyCode&&t.close()}))}};t.init(),window.newPopover=function(){t.init()}}()}).call(this,n(39))},351:function(e,t,n){},480:function(e,t,n){"use strict";n.r(t);var i=n(103),o=n.n(i),r=n(132),a=n.n(r);n(334),n(335),n(338),n(339),n(340),n(341),n(342),n(343),n(345),n(346),n(347),n(348),n(349),n(350),n(351);window.Uppy={AwsS3:a.a,Core:o.a}}},[[480,0]]]);